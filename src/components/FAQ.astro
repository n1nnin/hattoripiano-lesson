---
const faqItems = [
  {
    question: "楽器は必要ですか？",
    answer: "歌のレッスンの場合は必要ありません。ピアノの場合は自宅での練習のために必要ですが、事情がある場合は教室でのレッスンのみでも大丈夫です。",
  },
  {
    question: "レンタル楽器はありますか？",
    answer: "折りたたみキーボードを1〜2ヶ月お貸しすることが可能です。",
  },
  {
    question: "体験レッスンに下の子を連れていっても大丈夫ですか？",
    answer: "大丈夫です。お人形やぬいぐるみ、絵本などで遊べるスペースがあります。お飲物はお茶のみでお願いしております。",
  },
  {
    question: "振替レッスンはできますか？",
    answer: "学校行事等で早めにご連絡いただければ、空き時間で対応いたします。体調不良の際はLINEでの動画レッスンも可能です。",
  },
  {
    question: "発表会はありますか？",
    answer: "年1回、12月にワークピア磐田ホールで開催しています。ソロとアンサンブルの2本立てです。",
  },
  {
    question: "体験レッスンの申し込み方法は？",
    answer: "LINE公式アカウントからスタンプやコメントでお気軽にご連絡ください。",
  },
  {
    question: "子どもの頃に習っていましたが、長年ブランクがあります。大丈夫ですか？",
    answer: "全く問題ありません。当教室の大人の生徒さんの多くが、ブランクのある方です。体験レッスンで現在の状態を確認しながら、ご本人のペースでレッスンプランをご提案します。焦らず、楽しみながら再スタートしましょう。",
  },
  {
    question: "60代・70代の完全な初心者ですが、大丈夫ですか？",
    answer: "もちろん大丈夫です。現在も70代の生徒さんが楽しく通われています。楽譜が読めなくても、指の動かし方から丁寧にお教えします。「この歳から始められるかな」と不安な方こそ、ぜひ一度体験レッスンにいらしてください。",
  },
  {
    question: "保育士試験まで半年しかありません。間に合いますか？",
    answer: "試験までの期間や現在のレベルに合わせてカリキュラムを組みますので、ご安心ください。弾き歌いの実技指導にも対応しています。フリーレッスンを活用して集中的に通うことも可能です。まずは体験レッスンで現状を確認しましょう。",
  },
  {
    question: "発表会は必ず参加しなければいけませんか？",
    answer: "参加は任意です。年1回、12月にワークピア磐田ホールで開催していますが、ご本人やご家庭のご都合に合わせてお決めいただけます。見学だけでも大歓迎です。",
  },
  {
    question: "ゲームやアニメの曲、J-POPなども弾けますか？",
    answer: "はい、対応しています。クラシックだけでなく、ゲームBGM、アニメの主題歌、J-POP、バンド曲など、弾きたい曲を一緒に練習できます。「この曲が弾きたい！」という気持ちを大切にレッスンしています。",
  },
  {
    question: "中学生・高校生ですが、一人で通えますか？",
    answer: "もちろんです。中高生の生徒さんもお一人で通われています。男子も女子も大歓迎です。部活やバイトのスケジュールに合わせて、フリーレッスン（都度予約）もご利用いただけます。",
  },
  {
    question: "バンドのキーボードを練習したいのですが、教えてもらえますか？",
    answer: "はい、コードの押さえ方やリズムの取り方など、バンド演奏に必要な基礎からお教えします。ポピュラーピアノ・キーボードのレッスンにも対応していますので、お気軽にご相談ください。",
  },
];
---

<section id="faq" class="bg-cream-dark py-20 px-4" aria-labelledby="faq-heading">
  <div class="max-w-3xl mx-auto observe-fade">
    <!-- Section Heading -->
    <div class="text-center mb-12">
      <span class="font-accent text-brown-warm text-2xl">FAQ</span>
      <h2 id="faq-heading" class="font-heading text-3xl md:text-4xl text-brown mt-2">よくある質問</h2>
    </div>

    <!-- Accordion -->
    <div class="space-y-4">
      {faqItems.map((item, index) => (
        <div class="bg-white rounded-xl overflow-hidden shadow-sm" data-faq-item>
          <button
            class="w-full p-5 flex justify-between items-center cursor-pointer hover:bg-cream-dark transition text-left"
            data-faq-toggle
            aria-expanded="false"
            aria-controls={`faq-answer-${index}`}
          >
            <span class="font-heading text-brown text-lg pr-4">{item.question}</span>
            <span class="text-brown-warm flex-shrink-0 transition-transform duration-300" data-faq-icon>
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19" class="faq-vertical-line transition-opacity duration-300" />
                <line x1="5" y1="12" x2="19" y2="12" />
              </svg>
            </span>
          </button>
          <div
            id={`faq-answer-${index}`}
            class="faq-answer"
            role="region"
            style="max-height: 0; overflow: hidden; transition: max-height 0.35s ease, padding 0.35s ease;"
          >
            <div class="p-5 pt-0 text-brown-accent font-body leading-relaxed">
              {item.answer}
            </div>
          </div>
        </div>
      ))}
    </div>
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const toggleButtons = document.querySelectorAll("[data-faq-toggle]");

    toggleButtons.forEach((button) => {
      button.addEventListener("click", () => {
        const item = button.closest("[data-faq-item]");
        if (!item) return;

        const answer = item.querySelector(".faq-answer") as HTMLElement;
        const icon = button.querySelector("[data-faq-icon]") as HTMLElement;
        const verticalLine = button.querySelector(".faq-vertical-line") as SVGLineElement;
        const isOpen = button.getAttribute("aria-expanded") === "true";

        if (isOpen) {
          // Close
          answer.style.maxHeight = "0";
          button.setAttribute("aria-expanded", "false");
          if (verticalLine) verticalLine.style.opacity = "1";
        } else {
          // Close all others first
          document.querySelectorAll("[data-faq-item]").forEach((otherItem) => {
            const otherAnswer = otherItem.querySelector(".faq-answer") as HTMLElement;
            const otherButton = otherItem.querySelector("[data-faq-toggle]") as HTMLElement;
            const otherVertical = otherItem.querySelector(".faq-vertical-line") as SVGLineElement;
            if (otherAnswer && otherItem !== item) {
              otherAnswer.style.maxHeight = "0";
              otherButton?.setAttribute("aria-expanded", "false");
              if (otherVertical) otherVertical.style.opacity = "1";
            }
          });

          // Open this one
          answer.style.maxHeight = answer.scrollHeight + "px";
          button.setAttribute("aria-expanded", "true");
          if (verticalLine) verticalLine.style.opacity = "0";
        }
      });
    });
  });
</script>
